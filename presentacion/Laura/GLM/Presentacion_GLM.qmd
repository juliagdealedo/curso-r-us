---
title: "Modelos lineales generalizados (GLMs)"
format: 
  revealjs:
    theme: white    # Specify the 'night' theme here
    slide-number: true  # Optional: Show slide numbers
    self-contained: true
  html: 
    self-contained: true
    code-fold: true
    code-summary: "Show the code"
    code-tools: true
    toc: TRUE
    toc-location: left
    toc-depth: 3
    theme: flatly
---

## Introducción

1.   Definición

2.   Estructura

     2.1. Función de vínculo

     2.2. Familia de distribución de errores

***

## 1. Definición

Supuestos modelos lineales:

1. Los errores se distribuyen nromalmente

2. La varianza (residual) es constante

3. La variable respuesta se relaciona linealmente con la(s) variable(s) independiente(s), si alguna de estas variables es continua

Uno o varios supuestos no se cumplen.

¿Qué hacer?

***

[GLMs: extensión modelos lineales especificando estructuras no normales de errores y varianzas no constantes.]{style="font-size:20px"}

[Modelos lineales caso particular de GLMs con distribución de errores normal y varianza constante.]{style="font-size:20px"}

![Relación varianza y media (Cayuela y de la Cruz, 2022)](F:/Nextcloud13102025/CursoR/Github/curso-r-us/presentacion/Laura/GLM/media_varianza.png){width="500px" height="500px" fig-align="left"}

***

Tipos de variables que por definición violan supuestos modelos lineales:

- conteo de casos (p.ej. abundancia de especies)

- conteo de casos como proporciones (p.ej. porcentaje plántulas muertas en un experimento)

- respuesta binaria (p.ej. usado o no usado, presente o ausente)

***

## 2. Estructura

[3 componentes principales:]{style="font-size:30px"}

[1. El predictor lineal]{style="font-size:25px"}

[2. La función de vínculo]{style="font-size:25px"}

[3. La estructura de los errores]{style="font-size:25px"}

[Estructura modelos lineales:]{style="font-size:30px"}

[*y~i~ = β~0~ + β~1~x~1~ + ... + β~1~x~n~ + Ɛ~i~*]{style="font-size:25px"}

[*Ɛ~i~ ~N(0,σ^2^)*]{style="font-size:25px"}

[Estructura GLMs:]{style="font-size:30px"}

[*f(y~i~) = β~0~ + β~1~x~1~ + ... + β~1~x~n~ + Ɛ~i~*]{style="font-size:25px"}

[*Var(y) ~ f(µ)*]{style="font-size:25px"}

***

##### 2.1. La función de vínculo *f(y)*

[Transformación de la variable *y* buscando linealizar relación *y* con *x* y/o transformando en continuas variables que no lo son.]{style="font-size:25px"}

[Por tanto, cambia la naturaleza de la variable respuesta.]{style="font-size:25px"}

[Determinadas funciones de vínculo deben implementarse con determinados tipos de variables respuesta]{style="font-size:25px"}

![Función de vínculo (Cayuela y de la Cruz, 2022)](F:/Nextcloud13102025/CursoR/Github/curso-r-us/presentacion/Laura/GLM/funcion_vinculo.png){width="800px" height="300px" fig-align="left"}


***

##### 2.2. La familia de distribución de errores

a) Poisson: varianza aumenta linealmente con la media. Para respuestas tipo conteo.

b) Binomial negativa: extensión de Poisson. Para variables conteo con sobredispersión.

c) Binomial: para proporsiones y datos presencia/ausencia.

d) Gamma: para datos continuos con coeficiente de variación constante.

*** 
#### Ajuste GLM en R

Función glm()

Argumento family:

- binominal(link = "logit")
- gaussian(link = "identity)
- Gamma(link = "inverse")
- inverse.gaussian(link = "1/mu^2)
- poisson(link = "log")
- quasi(link = "identity", variance = "constant")

***

## Ejemplo con datos tipo conteo

***

Efecto ganadería en regeneración de araucaria. Muestreo de número de plantas de araucaria en dos tipos de ganadería: pequeños propietarios, con uso más intensivo de la tierra, y grandes empresas forestales, que mantienen algunos remanente bosque nativo. Actividad ganado medida por número de bostas.

***

```{r}
#| echo: true
library(ADER)
data(ara)
str(ara)
```

Hipótesis:

*H0: β = 0* (pendiente entre plántulas y número de bostas es 0)

*H0: µ~1~ = µ~2~* (número plántulas en pequeños propietarios y empresas sin diferencias)

*H0: β~1~ = β~2~* (relación entre plántulas y bostas es igual en pequeños propietarios y empresas)

***

### Exploración gráfica de los datos

```{r}
#| echo: true
#| attr-source: "style='font-size: 0.6em'"
#| attr-output: "style='font-size: 0.2em'"
#| fig-width: 9    # ancho en pulgadas
#| fig-height: 6    # alto en pulgadas
#| fig-align: "center"
library(ggplot2)
ggplot(ara, aes(x = dungs, y = seedlings)) +
  geom_point(color = "steelblue", size = 2) +
  facet_wrap(~ property) +
  labs(
    title = "Relación nº plántulas y nº bostas",
    x = "Nº bostas",
    y = "Nº plántulas"
  ) +
  theme_minimal()
```