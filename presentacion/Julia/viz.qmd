---
title: "Visualizaci√≥n de datos"
subtitle: "Analizar y visualizar datos en R con ggplot"
format: 
  revealjs:
    theme: solarized 
    smaller: true
    slide-number: true 
    self-contained: true
  html: 
    self-contained: true
    code-fold: true
    code-summary: "Show the code"
    code-tools: true
    toc: TRUE
    toc-location: left
    toc-depth: 3
    theme: flatly
---

## Visualizaci√≥n

Para entender patrones y relaciones

Para comunicar resultados de forma clara

Para detectar errores o valores at√≠picos

Porque una imagen resume m√°s que una tabla

![Matetja et al](images/plot.png)

## Colores üé®

En R, los colores se pueden definir por nombre ("red", "blue") o por su c√≥digo hexadecimal 

- "#72874E" ‚Üí formato #RRGGBB

- "#72874EFF" ‚Üí formato #RRGGBBAA, donde AA es la transparencia

### Paletas ya hechas
- RColorBrewer ‚Üí paletas cl√°sicas para mapas y gr√°ficos 
- viridis ‚Üí paletas perceptualmente uniformes y accesibles.
- MetBrewer ‚Üí paletas inspiradas en obras de arte.
- peRReo ‚Üí paletas con inspiraci√≥n musical y est√©tica moderna.
- scico ‚Üí paletas cient√≠ficamente equilibradas.

[scico](https://cran.r-project.org/web/packages/scico/readme/README.html)
[maps](https://www.fabiocrameri.ch/colourmaps/)
[met](https://github.com/BlakeRMills/MetBrewer)
[prr](https://github.com/jbgb13/peRReo)

## En R, desde gr√°ficos muy simples

```{r}

 
# 1. Cargar librer√≠as

library(dplyr)
library(ggplot2)
library(readr)
library(palmerpenguins)
library(scico)

# 2. Leer datos
data(package = 'palmerpenguins')

#| echo: true

plot(x=rnorm(100), y=rnorm(100))

```

------------------------------------------------------------------------

## hasta muy complejos

![qui√©n habla con qui√©n en "The Office"](images/complex_graph.png){width="550px" height="550px" fig-align="center"} [C√≥digo](https://r-graph-gallery.com/character-interaction-analysis.html)

## R base versus ggplot - simple

::::: columns
::: {.column width="50%"}

```{r}
#| echo: true

plot(penguins$bill_length_mm, 
     penguins$bill_depth_mm)

```
:::

::: {.column width="50%"}
```{r}
#| echo: true
ggplot(penguins, 
       aes(x = bill_length_mm, 
           y = bill_depth_mm)) +
  geom_point()

```
:::
:::::



## R base versus ggplot - complejo

::::: columns
::: {.column width="50%"}

```{r}
#| echo: true

ggplot (data = penguins, aes(x = bill_length_mm, y = bill_depth_mm)) +
  geom_point(aes(color = body_mass_g)) +
  scico::scale_color_scico(palette = "bamako", direction = -1) +
  scale_x_continuous(breaks = 3:6 * 10, limits = c(30, 60)) +
  scale_y_continuous(breaks = seq(12.5, 22.5, by = 2.5),
                     limits = c(12.5, 22.5)) + theme_minimal () +
  labs( title = 'Bill Dimensions of Brush-Tailed Penguins (Pygoscelis)',
    subtitle = 'A scatter plot of bill depth versus bill length.',
    caption = 'data = Gorman, Williams & Fraser (2014) PLoS ONE, graph = C√©dric Scherer',
    x = 'Bill Length (mm)',
    y = 'Bill Depth (mm)',
    color = 'Body mass (g)'
    ) + theme_minimal ()


```

:::
::: {.column width="50%"}


```{r}
#| echo: true

cols <- scico(100, palette = "bamako", direction = -1)
color_values <- cols[
  as.numeric(cut(penguins$body_mass_g, breaks = 100))
]

plot(
  penguins$bill_length_mm, penguins$bill_depth_mm,
  col = color_values, pch = 21, bg = color_values,  
  xlim = c(30, 60),  ylim = c(12.5, 22.5),
  xaxt = "n",  yaxt = "n",
  xlab = "Bill Length (mm)",
  ylab = "Bill Depth (mm)",
  main = "Bill Dimensions of Brush-Tailed Penguins (Pygoscelis)",
  sub = "A scatter plot of bill depth versus bill length."
)

# Le falta la leyenda a√∫n
```
:::
:::::


## Bases de ggplot

ggplot = Grammar of Graphics (gg)
Separa cada componente de un gr√°fico en componentes individuales, creando distintas capas. 
As√≠ tenemos resultados m√°s flexibles y personalizables.

::::: columns
::: {.column width="50%"}

- Data
- Aesthetics (x, y)
- Geometries (points, lines, boxplots)
- Scales (eg. colores)
- Facets (subplots)
- Statistics (show means, counts, and other statistical summaries of data)
- Coordinates
- Theme (apariencia general del gr√°fico)

:::

::: {.column width="50%"}

![Layers inside ggplot](images/layers.png)

:::
:::::
## Ejemplo de capas

![Hertz & McNeill 2024](images/ggplot_basics.png)

## Aesthetics

::::: columns
::: {.column width="50%"}

- x, y
- colour: color de los geoms (CONTORNO)
- fill: el color de dentro de los geoms (RELLENO)
- group: a qu√© grupo pertenece un geom
- shape: la forma de los puntos
- linetype: tipo de linea (solid, dashed, etc)
- size: escalar el tama√±o 
- alpha: transparencia

:::

::: {.column width="50%"}
![RforEcology.com](images/aesthetics.png)
:::
:::::

## Geometries

### Categ√≥rico 
- geom_bar(): bar charts for categorical x axis
- geom_boxplot(): box and whiskers plot for categorical variables
- geom_violin(): distribution kernel of data dispersion


### Continuo
- geom_histogram(): histogram for continuous x axis
- geom_point(): scatterplot
- geom_line(): lines connecting points by increasing value of x
- geom_path(): lines connecting points in sequence of appearance

## Scales
Scales se puede modificar el tipo de variable, transformarla, tama√±o, color, nombre etc.

-  scale_x_continuous() - transformar en continua
-  scale_x_sqrt() - transformar en ra√≠z cuadrada
-  scale_colour_discrete()  - a√±adir colores discretos
-  scale_colour_brewer() - a√±adir colores de una paleta
-  scale_fill_continuous () - a√±adir colores de relleno continuos
  
## Facets
- facet_wrap() 
- facet_grid() 

`facet_wrap(~ variable)`     | Divide el gr√°fico en **varios paneles seg√∫n una sola variable**. Coloca los paneles en una cuadr√≠cula flexible (se ‚Äúenvuelven‚Äù autom√°ticamente). 

`facet_grid(fila ~ columna)` | Divide los gr√°ficos seg√∫n **dos variables**: una define las filas y otra las columnas.

## Themes

![geeksforgeeks](images/themes.png)
Se pueden hacer personalizados tambi√©n

## Empecemos a visualizar

- Primero pensar qu√© queremos visualizar (dibujo?)
- El orden donde ponemos los argumentos
- Si van dentro de par√©ntesis o no
- d√≥nde va la base de datos a la que hacemos referencia

```{r}
#| echo: true
#| eval: false

# D√≥nde va la base de datos?
ggplot (BASE DE DATOS, aes (x, y, fill, color)) +
    geom_xxx () +
    theme ()

# Si trabajamos con dplyr antes
BASE DE DATOS %>%
    ggplot (aes (x, y, fill, color)) +
    geom_xxx () +
    theme ()

# Si trabajamos con varias bases de datos
ggplot () +
    geom_point (base_de_datos1, aes (x, y, fill, color)) +
    geom_line (base_de_datos2, aes (x, y, fill, color)) +
    theme ()
```

## LA CAPA 'DATA'
Volvemos con los ping√ºinos. 
ggplot = base de datos

```{r}
#| echo: true

ggplot(penguins)

```

## LA CAPA 'AESTHETICS'

::::: columns
::: {.column width="50%"}

ggplot = base de datos + aesthetics
```{r}
#| echo: true

ggplot(penguins, 
       aes(x = flipper_length_mm))

```

:::

::: {.column width="50%"}

La base de datos puede antes con el pipe de dplyr

```{r}
#| echo: true

penguins %>%
  ggplot(aes(x = flipper_length_mm))

```

:::
:::::

## LA CAPA 'GEOMETRIC'

ggplot + base de datos + aesthetics + geoms
```{r}
#| echo: true

ggplot(penguins, aes(x = flipper_length_mm)) +
  geom_histogram()

```

## Gr√°fico de densidad 

```{r}
#| echo: true

ggplot(penguins, 
       aes(x = flipper_length_mm)) + 
  geom_density(bw=1)

```

***

#### Gr√°fico de Barras

Geom_bar por defecto nos cuenta el numero de datos

```{r}
#| echo: true

penguins %>%
  ggplot (aes(x=species)) +
  geom_bar() 

```

***

#### Gr√°fico de Barras

Para que nos haga la suma, necesitamos "identity"

```{r}
#| echo: true

penguins %>%
ggplot(aes(x=species, y=bill_length_mm)) +
    geom_bar(stat="identity")
```
***

Para que haga la media, le decimos que la estad√≠stica (stat) es un "summary" con la funci√≥n "mean"

```{r}
#| echo: true

penguins %>%
ggplot(aes(x = species, y = bill_length_mm)) +
    geom_bar(stat="summary", fun = "mean")

```

***
#### CAMBIAMOS LOS COLORES

Queremos la especie en distintos colores. 

Dentro de aesthetics a√±adimos el argumento fill para cambiar el "relleno" segun el grupo que indiquemos. Nos dar√° un color ya establecido por ggplot.

```{r}
#| echo: true

penguins %>%
ggplot(aes(x=species, y=bill_length_mm, fill=species)) +
    geom_bar(stat="identity")

```

***

¬øQu√© pasa si modificamos "color"? ... mal
```{r}
#| echo: true

penguins %>%
ggplot(aes(x=species, y=bill_length_mm, color=species)) +
    geom_bar(stat="identity")
```

***
A√±adimos el labs y theme 

```{r}
#| echo: true

library(ggplot2)
penguins %>%
  ggplot(aes(x = species, y = bill_length_mm, fill=species)) +
  geom_bar(stat = "identity") +
  guides(fill = FALSE) +
  labs(
    title = "Longitud del pico en mm",
    subtitle = "Suma por especie",
    x = "Especie de ping√ºino",
    y = "Longitud del pico"
  ) + theme_minimal()

```

***

####  Inclu√≠mos una variable m√°s

A√±adiendo en "fill" el sexo del ping√ºino.

```{r}
#| echo: true


penguins %>%
  ggplot(aes(x = species, y = bill_length_mm, fill = sex)) +
  geom_bar(stat = "identity")


```
***

Quitamos NAs y a√±adimos position_dodge() para visualizarlos uno al lado del otro
```{r}
#| echo: true

penguins %>%
  filter(!is.na(sex)) %>%
  ggplot(aes(x = species, y = bill_length_mm, fill = sex)) +
  geom_bar(stat = "identity", position = position_dodge()) 
```
***

## Colores personalizados

```{r}
#| echo: true

penguins %>%
  filter (!is.na(sex)) %>%
  ggplot (aes(x = species, y = bill_length_mm, fill = sex)) +
  geom_bar (stat = "identity", position = position_dodge()) +
  scale_fill_manual (values = c("#72874EFF", "#FED789FF")) +
  theme_minimal () 

```

***

#### Boxplot

```{r}
#| echo: true

penguins %>% 
  ggplot (aes(x = island, y = bill_length_mm)) + 
  geom_boxplot ()

```

***

```{r}
#| echo: true

penguins %>% 
  ggplot (aes(x = island, y = bill_length_mm, fill=island)) + 
  geom_boxplot ()

```

***

```{r}
#| echo: true

penguins %>% 
  ggplot (aes(x = island, y = bill_length_mm, color=island)) + 
  geom_boxplot ()

```
## Cuidado con los boxplots!

![Seven distributions of data, shown as raw data points (of strip-plots), as box plots, and as violin plots](images/violin.gif) 

[Fuente](https://www.research.autodesk.com/publications/same-stats-different-graphs/)



## Violin plot

```{r}
#| echo: true

violin_plot <- penguins %>%
  ggplot (aes(x = island, y = bill_length_mm, fill = island)) +
  geom_jitter (size = 3,
               alpha = 0.1,
               fill = "grey") +
  geom_violin (alpha = 0.8) +  guides (fill = FALSE) +
  scale_fill_manual (values = c("#72874EFF", "#FED789FF", "#023743FF")) +
  theme_light() 

violin_plot

#ggsave("images/violin_plot.png", violin_plot, width = 20, height = 20, units = "cm", scale = .5)

```
## Guardar plots con ggsave

::::: columns
::: {.column width="50%"}

- ggsave("images/violin_plot.png", violin_plot, width = 20, height = 20, units = "cm", scale = .5)

- ggsave nos permite guardar en "eps", "ps", "tex" (pictex), "pdf", "jpeg", "tiff", "png", "bmp", "svg" or "wmf"

:::

::: {.column width="50%"}
![Violines](images/violin_plot.png){width="400px" height="400px" fig-align="left"}

:::
:::::




## Datos continuos
Miramos las correlaciones entre nuestras variables de manera gr√°fica
```{r}
#| echo: true

library(GGally)

penguins %>% 
  ggpairs(columns = 3:5, ggplot2::aes(colour=species)) 
  
```
## Scatterplots 

```{r}
#| echo: true

penguins %>% 
  ggplot (aes(x = flipper_length_mm, y = bill_length_mm)) + 
  geom_point() 

```

***

## Plotear texto
geom_text()

```{r}
#| echo: true

ggplot(penguins, aes(x = flipper_length_mm, y = bill_length_mm)) +
  geom_text(aes(label = 'pingus')) +
  theme_minimal()
```

## Cuidado con el argumento color y fill
Hay que estar atentos d√≥nde est√°n colocados
Si van dentro de aes() tiene que ser una variable y no un color per se.

```{r}
#| echo: true

penguins %>% 
  ggplot () + 
  geom_point(aes(x = flipper_length_mm, y = bill_length_mm, color="blue")) 

```

***

#### Aqu√≠ bien
Fuera de aesthetics s√≠ puede ser un color

```{r}
#| echo: true

penguins %>% 
  ggplot () + 
  geom_point(aes(x = flipper_length_mm, y = bill_length_mm), color="blue") 

```

***

#### Color
Dentro de aesthetics tiene que ser una variable de nuestra bbdd

```{r}
#| echo: true

penguins %>% 
  ggplot (aes(x = flipper_length_mm, y = bill_length_mm, colour = island)) + 
  geom_point() + theme_light() 

```

## LA CAPA 'SCALES'

#### Color categ√≥rico

```{r}
#| echo: true

penguins %>% 
  ggplot (aes(x = flipper_length_mm, y = bill_length_mm, colour = island)) + 
  geom_point() + 
  scale_colour_manual(values=c("#72874EFF", "#FED789FF", "#023743FF")) +
  theme_light() 

```

***

#### Color continuo

```{r}
#| echo: true

penguins %>% 
  ggplot (aes(x = flipper_length_mm, y = bill_length_mm, colour = bill_length_mm)) + 
  geom_point() + theme_light() 

```

***

#### Gradientes de color

```{r}
#| echo: true

penguins %>% 
  ggplot (aes(x = flipper_length_mm, y = bill_length_mm, colour = bill_length_mm)) + 
  geom_point() +
  scale_color_gradient(low="#00AFBB", high="#E7B800")+
  theme_light() 

```

***

#### Colores continuos de paletas (viridis)

```{r}
#| echo: true

penguins %>% 
  ggplot (aes(x = flipper_length_mm, y = bill_length_mm, colour = bill_length_mm)) + 
  geom_point() +
  scale_color_viridis_c(option = "plasma") + 
  theme_light() 

```

***

#### Colores continuos de paletas (RColorBrewer)

```{r}
#| echo: true

penguins %>% 
  ggplot (aes(x = flipper_length_mm, y = bill_length_mm, colour = bill_length_mm)) + 
  geom_point() +
  scale_color_distiller(palette = "Spectral") +  # otras: "RdYlBu", "YlGnBu", "PuOr", etc.
  theme_light() 

```

***

#### Cambiar el tama√±o del punto

```{r}
#| echo: true

penguins %>% 
  ggplot (aes(x = flipper_length_mm, y = bill_length_mm, size = body_mass_g, color=body_mass_g)) +
  scale_color_gradient(low="orange",high="black")+
  geom_point(alpha=0.8) + theme_light() 

```

## Otras visualizaciones de los mismos datos

Densidades en dos dimensiones 

```{r}
#| echo: true

# Show the contour only
penguins %>% 
ggplot (aes(x = flipper_length_mm, y = bill_length_mm))+
  geom_density_2d(color="black") + theme_minimal ()
```



## LA CAPA STATISTICS

```{r}
#| echo: true

penguins %>% 
  ggplot (aes(x = flipper_length_mm, y = bill_length_mm)) + 
  geom_point() + geom_smooth()
# Method = "loess"
```
 
***
 
#### Modelos lineales

Podemos visualizar c√≥mo quedar√≠a un modelo lineal

```{r}
#| echo: true

penguins %>% 
  ggplot (aes(x = flipper_length_mm, y = bill_length_mm)) + 
  geom_point() + theme_light() + geom_smooth(method = "lm")

```

***
 
#### Modelos lineales con interacci√≥n

```{r}
#| echo: true

penguins %>% 
  ggplot (aes(x = flipper_length_mm, y = bill_length_mm, colour = island)) +
  geom_point () +
  scale_colour_manual (values=c("lightblue", "purple", "pink")) +
  theme_light() + geom_smooth(method = "lm")

```

## LA CAPA 'FACETS'

Dividir por especie
```{r}
#| echo: true

penguins %>% 
  ggplot (aes(x = flipper_length_mm, y = bill_length_mm, colour = island)) + 
  scale_colour_manual (values=c("lightblue", "purple", "pink")) +
  geom_point() + theme_light() +  facet_wrap(~species, scales = "free")



```

***

#### Dividir por especie y por isla

```{r}
#| echo: true

penguins %>% 
  ggplot (aes(x = flipper_length_mm, y = bill_length_mm, colour = island)) + 
  scale_colour_manual (values=c("lightblue", "purple", "pink")) +
  geom_point() + theme_light() +  facet_wrap(species~island, scales = "free")

```

***

#### facet grid por pares

```{r}
#| echo: true

penguins %>% 
  ggplot (aes(x = flipper_length_mm, y = bill_length_mm, colour = island)) + 
  scale_colour_manual (values=c("lightblue", "purple", "pink")) +
  geom_point() + theme_light() +  facet_grid(species~island, scales = "free")

```

## Patchwork

Guardamos los ggplots como objetos y los "sumamos"

```{r}
#| echo: true

library(patchwork)

p1 <- penguins %>% 
  ggplot (aes(x = flipper_length_mm, y = bill_length_mm, color = species, fill=species)) +
  geom_point(alpha=.5) + theme_light()  + geom_smooth(method = "lm")

p2 <- penguins %>% 
  ggplot (aes(fill = species, x = bill_length_mm)) + 
  geom_density(alpha=.5) + theme_light() + coord_flip()

p1 + p2 
```
***
o "separamos"
```{r}
#| echo: true

p1 <- penguins %>% 
  ggplot (aes(x = flipper_length_mm, y = bill_length_mm, color = species, fill=species)) +
  geom_point(alpha=.5) + theme_light()  + geom_smooth(method = "lm")

p2 <- penguins %>% 
  ggplot (aes(fill = species, x = flipper_length_mm)) + 
  geom_density(alpha=.5) + theme_light() 

p1 / p2 
```

## Mapas I

![Mapa del crecimiento urbano en Valencia](images/map-growth.png){width="600px" height="550px" fig-align="left"}
[C√≥digo](https://dominicroye.github.io/blog/visualize-urban-growth/index.html)

## Mapas II

![Apicultores en Alemania](images/bee.png){width="600px" height="600px" fig-align="left"} 
[C√≥digo](https://www.cedricscherer.com/top/dataviz/)

## Nuestros datos georeferenciados

```{r}
#| echo: true

library(rgbif)
library(ggplot2)
library(rnaturalearth)
library(sf)

datos <- occ_search(scientificName = "Lynx pardinus", limit = 100)
df <- datos$data
world <- ne_countries(scale = "medium", returnclass = "sf")

# Plot
ggplot() +
  geom_sf(data = world, fill = "grey90", color = "grey30") +
  geom_point(data = df, aes(x = decimalLongitude, y = decimalLatitude),
             color = "darkred", size = 2, alpha = 0.7) +
  coord_sf() +
  theme_minimal()

```

***

```{r}
#| echo: true

# Basic map
iberian_peninsula <- ne_countries(country=c("spain", "portugal"))
ggplot() +
  geom_sf(data = iberian_peninsula, fill = "grey99", color = "grey30") +
  geom_point(data = df, aes(x = decimalLongitude, y = decimalLatitude),
             color = "darkgreen", size = 2, alpha = 0.7) +
  coord_sf() +
  theme_minimal()

```

## Mapa plantas

```{r}
#| echo: true

library(FloraIberica)
map_distribution(genus = "Lavandula", species = "stoechas", size = 0.9)

```

## gg cosas

![example ggimage R logo](images/ggimage.png){width="600px" height="400px" fig-align="left"}

***

![example emogg R logo](images/emogg.png){width="600px" height="600px" fig-align="left"}

***

![gganimate](images/gganimate.gif){width="600px" height="600px" fig-align="left"}

***

### ggDNAvis 
It is an R package that uses ggplot2 to visualise genetic data

```{r}
#| echo: true
#| attr-source: "style='font-size: 0.5em'"
#| attr-output: "style='font-size: 0.3em'"

library(ggDNAvis)
sequence <- paste(c(rep("GGC", 72), rep("GGAGGAGGCGGC", 15)), collapse = "")

visualise_single_sequence(
    sequence = sequence,
    sequence_colours = sequence_colour_palettes$bright_pale,
    background_colour = "white",
    line_wrapping = 60,
    spacing = 1,
    margin = 0.5,
    sequence_text_colour = "black",
    sequence_text_size = 1,
    index_annotation_colour = "darkred",
    index_annotation_size = 1,
    index_annotation_interval = 1,
    index_annotation_vertical_position = 1/3,
    outline_colour = "black",
    outline_linewidth = .4,
    outline_join = "mitre",
    return = TRUE,
    render_device = ragg::agg_png,
    pixels_per_base = 100
)


```
[code ggDNAvis](https://ejade42.github.io/ggDNAvis/)

## Bibliograf√≠a

[Valentina de Filippo](https://www.tandfonline.com/doi/full/10.1080/00031305.2017.1375989#d1e199)
[Tips tables](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1012604)

[ggbasics](http://r.qcbs.ca/workshop03/book-en/grammar-of-graphics-gg-basics.html)

[book](https://link.springer.com/book/10.1007/0-387-28695-0)

[grphs](https://r-graphics.org/RECIPE-QUICK-SCATTER.html)

[geels](https://www.geeksforgeeks.org/r-language/themes-and-background-colors-in-ggplot2-in-r/)

## Ejercicios

1. Haz el violin_plot de antes pero los jitter son del color de la isla.

```{r}
#| echo: true

penguins %>% 
  ggplot (aes(x = island, y = bill_length_mm, fill = island)) + 
  geom_jitter (size=3, alpha=0.1, fill="grey") +
  geom_violin(alpha=0.8) +  guides (fill= FALSE)+
  scale_fill_manual(values=c("#72874EFF", "#FED789FF", "#023743FF")) +
  theme_light() + theme(rect = element_rect(fill = "transparent"))
```


2. Lee la base de datos de "cobertura.csv" 
- Haz un scatterplot comparando biomasa y cobertura, se√±alando las diferencias entre sequia o lluvia. 
- Haz un boxplot por los dos tipos de sequ√≠a y la cobertura de √°rboles


## Resolvemos los ejercicios

```{r}
#| echo: true

penguins %>% 
  ggplot (aes(x = island, y = bill_length_mm, fill = island)) + 
  geom_jitter (aes(color=island), size=2, alpha=0.9) +
  scale_color_manual(values=c("#72874EFF", "#FED789FF", "#023743FF")) +
  geom_violin (alpha=0.8) +  guides (fill= FALSE)+
  scale_fill_manual(values=c("#72874EFF", "#FED789FF", "#023743FF")) +
  theme_light() + theme(rect = element_rect(fill = "transparent"))


```

***

```{r}
#| echo: true

library(here)
cobertura <- read.csv(here("data/cobertura.csv"))
head(cobertura)

ggplot(cobertura) +
  geom_point(aes(x=biomasa, y=cobertura, color=sequia))

ggplot(cobertura) +
  geom_boxplot(aes(x=biomasa, y =cobertura, group=sequia))
```

***

tip: sin leyenda 
guides (fill=FALSE)


```{r}
#| echo: true

penguins %>%
ggplot(aes(x=species, y=bill_length_mm, fill=species)) +
    geom_bar(stat="identity")+
    guides(fill=FALSE)

```

