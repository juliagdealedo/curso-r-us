---
title: "Introducción a R"
subtitle: "Crear código en R, uso colaborativo y reproducible"
format: 
  revealjs:
    theme: solarized    
    slide-number: true  
    self-contained: true
  html: 
    self-contained: true
    code-fold: true
    code-summary: "Show the code"
    code-tools: true
    toc: TRUE
    toc-location: left
    toc-depth: 3
    theme: flatly
---

-   Introducción
-   Escribir en R
-   Buenas prácticas
-   Uso colaborativo

------------------------------------------------------------------------

## Introducción

R es un lenguaje y entorno de programación especializado en:

Análisis estadístico, visualización de datos y ciencia de datos.

Utilizado por investigadores, analistas y científicos para explorar, modelar y comunicar información basada en datos de forma eficiente y reproducible.

------------------------------------------------------------------------

## Lo que vas a aprender:

-   Mejorar la comprensión y la práctica estadística.

-   Desarrollar habilidades en programación en R.

-   Aprender flujos de trabajo eficientes, limpios y reproducibles.

-   Saber buscar información

-   No enredarse en errores

## Lo que **no** vas a aprender

1.  A programar en plan pro sin mirar internet o chatgpt

2.  A hacer páginas web

3.  A dejar de pelearte con la estadística

## Objetivos de la clase

```{r}
#| echo: false
library(here)
library(tidyverse)
library(tm)
library(wordcloud2)
library(readxl)

datos_curso = read_excel(here("data/datos-curso.xlsx"))
datos_curso_filtrado <- datos_curso |>
  rename (curso = "Curso de la primera matrícula en el programa de doctorado",
         experiencia = "Cuéntanos tu experiencia con R",
         comentarios = "Observaciones",
         email = "Correo electrónico") |>
  select (curso, experiencia, comentarios, email) |>
  mutate (email = str_replace(email, "anonymous", "anónimo"))

words <- tolower(
                unlist(
                  strsplit(datos_curso_filtrado$experiencia, " ") ) ) 

words <- gsub("[[:punct:][:digit:]]", "",words)
stop_es <- stopwords("spanish")
words_clean <- words[!words %in% stop_es]

# Plot
wordcloud2(data=table(words_clean), size=1,
           color = rep(RColorBrewer::brewer.pal(11, "PRGn"), 20))


```

## R y Rtudio

R → Es el lenguaje de programación y el motor que realiza los cálculos estadísticos y el análisis de datos.

RStudio → Es un entorno de desarrollo integrado (un programa) que facilita el uso de R con una interfaz amigable, paneles, autocompletado y herramientas visuales.

## ¿Qué puede hacer R?

R es una calculadora

Puede leer tablas, generarlas, guardarlas

Hacer estadística compleja (y sobre todo basada en biología)

Crear páginas webs, gráficos interactivos, presentaciones,

Crear nuevos paquetes de R

Hacer funciones

## Workflow: lo básico básico

Es una calculadora

```{r}
#| echo: true
2 + 3     
10 - 4    
3 * 5     
20 / 4    
```

## Acumular información

La magia de los objetos

```{r}
#| echo: true

x <- 10    
y <- 5
suma <- x + y
suma
suma + 7
```

------------------------------------------------------------------------

## Espera, pero ¿qué son los objetos?

Los objetos empiezan por una letra

Son sensibles a mayusculas

Tienen que llevar nombres coherentes y un orden

```{r}
#| echo: true

yo_uso_la_serpiente <- 10
OtraGenteUsaElCamello <- 9
otra.gente.usa.los.puntos <- 9
Hayque_evitar.esto10 <- 2

```

## Tipos de objetos

Hay muuchos tipos de objetos
- numéricos
- caracteres
- matrices, tablas
- listas
- modelos
- polígonos
- funciones


```{r}
#| echo: true

numero <- 1:10
numero
caracter <- "del uno al diez"
caracter
#numero * caracter

```

## Vectores y operaciones

```{r}
#| echo: true
#| attr-source: "style='font-size: 0.5em'"
#| attr-output: "style='font-size: 0.3em'"

numeros <- c(1, 2, 3, 4, 5) 
otros_numeros <- 1:40
otros_numeros
otros_numeros + 10
promedio <- mean(numeros)
promedio
promedio * numeros
numeros / otros_numeros
```

## Generadores de distribuciones

```{r}
#| echo: true
#| attr-source: "style='font-size: 0.5em'"
#| attr-output: "style='font-size: 0.3em'"
# Consecutivos del 1:10
1:10

# Un vector de 5 números aleatorios con distribución uniforme
runif(5)

# Ahora que 3 números vayan del 0 al 100
runif(3, min=0, max=100)

# 4 números con una distribución normal
rnorm(4)

# Especificando la media y la desviación
x <- rnorm(400, mean=50, sd=10)

# Sample = elegir 3 bolas de un bingo en el que hay 100
sample(0:100, 3, replace=TRUE) 

# Generador de secuencias: del 0 al 100 cada 10
seq(0, 100, 10)

```

## Crear funciones

Las funciones son aplicaciones que nos permiten realizar operaciones muy diversas. 

- Funciones que vienen con la distribución base de R o en los paquetes
- Crear nuestras propias funciones con function(). 
- Asignarle un nombre 
- indicar argumentos
- escribir entre llaves el código

## Ejemplo de funciones

```{r}
#| echo: true
#| attr-source: "style='font-size: 0.5em'"
#| attr-output: "style='font-size: 0.3em'"
# Queremos la media de nuestros números transformados a logaritmo

vector <- seq(1, 100, 10)
mean (log (vector))
sd (log (vector))

vector2 <- seq(1, 300, 50)
mean (log (vector2))
sd (log (vector2))

log_vect <- function (y) {
  mean_y <- mean (log (y+1))
  sd_y <- sd (log (y+1))
  print(paste("La media es", mean_y, ", la desviación estándar es:", round(sd_y,2)))
  return(log(y))
}

vector3 <- seq(1, 300, 4)
distribution = log_vect (vector3)
hist(distribution)


```

## Ayuda, Pipes, shortcuts

Ayuda en R o también vale buscar en google "function mean in R"

```{r}
#| echo: true
#| attr-source: "style='font-size: 0.5em'"
#| attr-output: "style='font-size: 0.3em'"

# Ayudas
?mean           # abre la ayuda de una función
help(mean)      # lo mismo que '?mean'
??"normal"      # búsqueda más amplia en toda la documentación
example(mean)   # muestra ejemplos prácticos

# <- es lo mismo que =
# $ para seleccionar columnas 
# [ ] para seleccionar partes de un vector o una tabla
```
*Pipes: cómo encadenar operaciones*

Los "pipes" permiten escribir código paso a paso, de forma legible:

```{r}
#| echo: true
#| attr-source: "style='font-size: 0.5em'"
#| attr-output: "style='font-size: 0.3em'"

library(dplyr)

# El propio de dplyr
iris %>%
  filter(Sepal.Length > 5) %>%
  summarise(promedio = mean(Sepal.Width))
# (control  (command) + shift + M)

# el de R desde hace dos años
iris |>
  filter(Sepal.Length > 5) |>
  summarise(promedio = mean(Sepal.Width))

```

## Ejercicios

```{r}
#| echo: true
#| attr-source: "style='font-size: 0.5em'"
#| attr-output: "style='font-size: 0.3em'"
# 1. Calcula el minimo valor de 100 valores aleatorios según una distribución normal
min (rnorm (100))

# 2. Dada una secuencia de 20 números seguidos (del 0 al 20), genera los pares y guárdalo en un objeto.
pares <- seq (0, 20, 2)

# 3. Ejercicio:

  # Crea un vector con 20 números aleatorios entre 0 y 50.
  # Calcula el promedio y la desviación estándar.
  # Multiplica todos los valores por 2.
  # Dibuja un histograma.
  #¿Cómo cambia el promedio después de multiplicar por 2?

mi_vector <- runif(20,0,50)
mean (mi_vector)
sd (mi_vector)
mi_vector_2 <- mi_vector*2
hist(mi_vector_2)
```

## Ejercicios opcionales

```{r}
#| echo: true
#| attr-source: "style='font-size: 0.5em'"
#| attr-output: "style='font-size: 0.3em'"

# 4. Haz una función que me diga si un número cualquiera es par o no (opcional)
que_tipo_de_numero_soy <- function (x) {
ifelse(x %% 2 == 0, "par", "impar")
}


```

## Compartir código

-   git. Es una herramienta de control de versiones que además permite trabajar en equipo
-   GitHub (portfolio de programador) ![Perfil](images/github.png)

------------------------------------------------------------------------

## Escribir textos, informes, artículos

-   Quarto
-   Rmarkdown
-   Ciencia reproducible y limpia

## Bibliografía

[cookbook](http://www.cookbook-r.com/)
